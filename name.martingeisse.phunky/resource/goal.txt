
The goal of Phunky is NOT to replicate all the weirdness of the real PHP. If
somebody wants that, just use PHP. Instead, Phunky should be *less* weird,
and prevent mistakes where PHP encourages them. Where PHP causes people to write
buggy programs, Phunky should not replicate this behavior.

The goal of Phunky is NOT to be a drop-in replacement for PHP. Such a thing is
not needed. Instead, Phunky should be designed for places where PHP sucks, such
as scripting another application. 

It is nice if Phunky supports running existing PHP applications and frameworks.
However, clean design should not be sacrificed to achieve this goal, even less
to run existing code *unchanged*. 

Example: PHP does not use a unified internal string encoding. String literals
are simply stored in whatever encoding the source file used. Phunky, in contrast,
expects source code to be UTF-8 encoded, and converts string literals to an
internal encoding (one string element per Unicode character) that PHP doesn't
even have. 

----------------------------------

Finding the goal of the Phunky project is becoming more important because PHP
shows more and more weirdness the deeper you dig:
	
	$$x = 15; // uses the variable $x as the name of the variable to set...
		// not really weird but error-prone and marginally useful
		
	Operator precendence documentation is wrong, and the English and German
		versions tell vastly different things. Real operator precedence in the
		implementation is often not as expected ( == >=, ?:)

	$ is explained as an operator, but actually isn't (can only be used in a few
		special places)
		
	References to array elements do not work as explained, because references
		in general work different as explained. (Explained: multiple names for
		one variable; actual: reference flag in zval structure)
	
Therefore, it is important to find the purpose of the whole project:
- drop-in replacement for PHP, runs PHP projects...?
- PHP-like scripting language for applications...?
- PHP-like application development language...?

----------------------------------

The "goal question" can be mitigated by saying, "Phunky is a framework to implement
PHP-like languages, including a 100% compatible PHP clone" -- not a language itself.
I need a good naming scheme then, so the framework won't be confused with the
language. (-> "Phun" = Language, "Phunky" = Framework ?)

PHP vs. PHP+: 
- AST classes that support the constructs from both Ls
- different parsers (or parser with feature flags), e.g.
	- PHP ?: behavior, PHP+ forbids ?: chaining
	- indirect variable access ($$x) in PHP, PHP+ forbids these
	- == vs. >= precedence (this probably needs a different parser)
- behavior of references -- this is going to be tough (but see below)
- string encoding:
	- parser option how to treat string literals
	- implementation class BinaryString vs. Java String (uses a byte[] instead of char[],
		doesn't store an encoding).
	- alt. implementation: use String (char[]) to store a byte array)
	- probably needs a different set of built-in string handling functions
	- going to be cumbersome because this needs to be supported in *all* extensions
		f.ex. MySQL: Java wants to use Strings and encode them at the end, this itself
		is a problem with MySQL because the encoding handling of MySQL is unclear; how
		table encoding and connection encoding work together. Binary Strings add
		another layer of complexity: a BinaryString needs an encoding to become a String,
		that is then sent to MySQL.
			-> JDBC has a connection encoding: http://stackoverflow.com/questions/3040597/jdbc-character-encoding
			Unclear if it actually re-codes strings if it is using the wrong encoding. Might be
			that the JDBC encoding is used to turn Java Strings into Binary Strings again
			and MySQL only uses binary strings.
			-> MySQL actually *does* a re-coding, but to an encoding that can be configured, so it is
			   still unclear how this relates to the encoding used in target tables:
			   http://dev.mysql.com/doc/refman/5.0/en/charset-connection.html
		-> Extensions need a helper funtion that converts a value to a string of an extension-defined
			(passed-as-parameter) encoding. This will turn non-string values to string, encode Java
			strings using that encoding, and re-code BinaryStrings (from what encoding !? -> maybe not
			re-code but *interpret* binary strings using that encoding).

The encoding issues alone suggest that building a drop-in replacement for PHP is going to be
extremely hard, not to mention reproducing all weird behavior of the standard library. 
->
Seems like building just a PHP-like language for application scripting is much more fun.

----------------------------------

References: I think to rebuild references even remotely they work as in PHP, I have to rebuild the
"zval" structure. Anything else is going to be different. This isn't going to be nice performance-wise,
but then, nothing is. Performance lies in optimized libraries that are implemented in Java; the PHP
code is going to be slow either way.

This also makes aiming for a 100% PHP compatibility mode easier (encodings will still be tough). But if encodings
are the last hurdle, there's at least some hope to be fully compatible, and this would probably attract *lots*
of developers.


