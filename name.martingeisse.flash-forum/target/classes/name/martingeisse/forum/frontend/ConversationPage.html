<?xml version="1.0" encoding="UTF-8" ?>
<html>
	<wicket:head>
		<script type="text/javascript">
			$(function() {
				function submitHelper() {
					$('#postForm').submit();
					$('#postForm textarea').prop('disabled', true);
					$('#uploader').css('display', 'none');
				}
				$('#postForm textarea').keydown(function(event) {
					if (event.which == 0xa || event.which == 0xd) {
						if (!event.shiftKey) {
							submitHelper();
							return false;
						}
					}
					return true;
				});
				$('#uploader').change(submitHelper);
				$(document.body).on('dragenter', function(event) {
					$('#uploader').css('display', 'block');
				});
				$('#uploader').on('dragleave', function(event) {
					$('#uploader').css('display', 'none');
				});
			});
			$(window).load(function() {
				// scrolling down only works after handling the current event has been
				// completed, so we register a callback to scroll down right after that
				setTimeout(function() {
					$('#scrollAnchor')[0].scrollIntoView();
				}, 0);
			});
		</script>
	</wicket:head>
	<body>
		<wicket:extend>
			<div wicket:id="posts" style="margin-bottom: 20px;">
				<b wicket:id="authorName">Author</b>
				<div wicket:id="body">body</div>
			</div>
			<form wicket:id="postForm" id="postForm">
				<textarea wicket:id="textarea" style="display: block; width: 100%; height: 100px; margin-bottom: 5px; " />
				<input type="file" wicket:id="uploader" id="uploader" style="display: none; position: absolute; top: 0px; bottom: 0px; left: 0px; width: 500%; opacity: 0; " />
				<div style="text-align: right;">
					<input type="submit" style="width: 200px; height: 35px;" />
				</div>
			</form>
			<div id="scrollAnchor" />
			<wicket:fragment wicket:id="postImageFragment">
				<img wicket:id="image" />
			</wicket:fragment>
		</wicket:extend>
	</body>
</html>
